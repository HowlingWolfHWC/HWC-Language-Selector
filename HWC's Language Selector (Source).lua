Font.fmLoad();

rescuePath={};
rescuePath[1]="mass:/PS2/APPS/WLE/WLE.ELF";
rescuePath[2]="mass:/PS2/APPS/WLE_ISR/WLE_ISR.ELF";
rescuePath[3]="mass:/PS2/APPS/WLE_ISRHDD/WLE_ISRHDD.ELF";
rescuePath[4]="mass:/PS2/APPS/WLE_KHN/WLE_KHN.ELF";
rescuePath[5]="mass:/PS2/APPS/WLE_SMB/WLE_SMB.ELF";
rescuePath[6]="mass:/PS2/APPS/WLE_HWC/WLE_HWC.ELF";
rescuePath[7]="mass:/PS2/APPS/ULE_442D/ULE_442D.ELF";
rescuePath[8]="mass:/PS2/APPS/ULE_437/ULE_437.ELF";
rescuePath[9]="mass:/PS2/APPS/LBFN/LBFN.ELF";
rescuePath[10]="mc0:/BOOT/BOOT.ELF";
rescuePath[11]="mc0:/APPS/ULE.ELF";
rescuePath[12]="mc0:/WLE/WLE.ELF";
rescuePath[13]="mc0:/ULE/ULE.ELF";
rescuePath[14]="mc0:/APPS/LBFN.ELF";
rescuePath[15]="mc0:/LBFN/LBFN.ELF";
rescuePath[16]="mc1:/BOOT/BOOT.ELF";
rescuePath[17]="mc1:/APPS/ULE.ELF";
rescuePath[18]="mc1:/WLE/WLE.ELF";
rescuePath[19]="mc1:/ULE/ULE.ELF";
rescuePath[20]="mc1:/LBFN/LBFN.ELF";
rescuePath[21]="mc1:/APPS/LBFN.ELF";

ESRPath={};
ESRPath[1]="mass:/PS2/APPS/ESR/ESR.ELF";
ESRPath[2]="mass:/PS2/APPS/ESR_GUI/ESR_GUI.ELF";
ESRPath[3]="mc0:/BOOT/ESR.ELF";
ESRPath[4]="mc0:/APPS/ESR.ELF";
ESRPath[5]="mc0:/ESR/ESR.ELF";
ESRPath[6]="mc0:/ESR_GUI/ESR_GUI.ELF";
ESRPath[7]="mc1:/BOOT/ESR.ELF";
ESRPath[8]="mc1:/APPS/ESR.ELF";
ESRPath[9]="mc1:/ESR/ESR.ELF";
ESRPath[10]="mc1:/ESR_GUI/ESR_GUI.ELF";

ESRTryToGuess={};
ESRTryToGuess[1]="ESR beta r9b dvdv direct.elf";
ESRTryToGuess[2]="ESR beta r9b dvdv direct off.elf";
ESRTryToGuess[3]="ESR beta r9b mcard.elf";
ESRTryToGuess[4]="ESR beta r9 dvdv direct.elf";
ESRTryToGuess[5]="ESR beta r9 dvdv direct off.elf";
ESRTryToGuess[6]="ESR beta r9 mcard.elf";
ESRTryToGuess[7]="ESR beta r9a dvdv direct.elf";
ESRTryToGuess[8]="ESR beta r9a dvdv direct off.elf";
ESRTryToGuess[9]="ESR beta r9a mcard.elf";
ESRTryToGuess[10]="ESR beta r8 dvd direct off.elf";
ESRTryToGuess[11]="ESR beta r8 dvdv direct.elf";
ESRTryToGuess[12]="ESR beta r8 mcard.elf";
ESRTryToGuess[13]="ESR beta r8a dvdv direct off.elf";
ESRTryToGuess[14]="ESR beta r8a dvdv direct.elf";
ESRTryToGuess[15]="ESR beta r8a mcard.elf";
ESRTryToGuess[16]="ESR beta r8a+ mcard.elf";
ESRTryToGuess[17]="ESR beta r8a  mcard.elf";
ESRTryToGuess[18]="ESR beta r6b dvdv direct.elf";
ESRTryToGuess[19]="ESR beta r6b mcard.elf";
ESRTryToGuess[20]="ESR beta r7a dvdv direct.elf";
ESRTryToGuess[21]="ESR beta r7a mcard.elf";
ESRTryToGuess[22]="ESR beta r7b dvdv direct.elf";
ESRTryToGuess[23]="ESR beta r7b mcard.elf";
ESRTryToGuess[24]="ESR_R9B_DIRECT_OFF.ELF";
ESRTryToGuess[25]="ESR_R9B_MCARD.ELF";
ESRTryToGuess[26]="ESR_R9B_DIRECT.ELF";
ESRTryToGuess[27]="ESRON.ELF";
ESRTryToGuess[28]="ESRDO.ELF";
ESRTryToGuess[29]="ESROFF.ELF";
ESRTryToGuess[30]="ESRCON.ELF";
ESRTryToGuess[31]="ESRCDO.ELF";
ESRTryToGuess[32]="ESRCOFF.ELF";
ESRTryToGuess[33]="esrgui.elf";
ESRTryToGuess[34]="esrgui_c.elf";
ESRTryToGuess[35]="ESR_GUI_test2.elf";
ESRTryToGuess[36]="ESR_GUI_test3.elf";
ESRTryToGuess[37]="esr_r9c_direct_off.elf";
ESRTryToGuess[38]="esr_r9c_direct.elf";
ESRTryToGuess[39]="esr_r9c_mcard.elf";
ESRTryToGuess[40]="esr_r10c_direct_off.elf";
ESRTryToGuess[41]="esr_r10c_direct.elf";
ESRTryToGuess[42]="esr_r10c_mcard.elf";
ESRTryToGuess[43]="esr_r10d_direct_off.elf";
ESRTryToGuess[44]="esr_r10d_direct.elf";
ESRTryToGuess[45]="esr_r10d_mcard.elf";
ESRTryToGuess[46]="esr_r10e_direct_off.elf";
ESRTryToGuess[47]="esr_r10e_direct.elf";
ESRTryToGuess[48]="esr_r10e_mcard.elf";
ESRTryToGuess[49]="esr_r10f_direct_off.elf";
ESRTryToGuess[50]="esr_r10f_direct.elf";
ESRTryToGuess[51]="esr_r10f_mcard.elf";

HWCgfx_background = Graphics.loadHWCImage(1)
HWCgfx_countryflags = Graphics.loadHWCImage(2)
HWCgfx_disc={};
HWCgfx_disc[1] = Graphics.loadHWCImage(3)--audiocd
HWCgfx_disc[2] = Graphics.loadHWCImage(4)--dvdvideo
HWCgfx_disc[3] = Graphics.loadHWCImage(5)--error
HWCgfx_disc[4] = Graphics.loadHWCImage(6)--ps2cd
HWCgfx_disc[5] = Graphics.loadHWCImage(7)--ps2dvd
HWCgfx_disc[6] = Graphics.loadHWCImage(8)--psone
HWCgfx_disc[7] = Graphics.loadHWCImage(9)--unk
HWCgfx_key_la = Graphics.loadHWCImage(10)
HWCgfx_key_left = Graphics.loadHWCImage(11)
HWCgfx_key_ra = Graphics.loadHWCImage(12)
HWCgfx_key_right = Graphics.loadHWCImage(13)
HWCgfx_memorycard = Graphics.loadHWCImage(14)
HWCgfx_overlay = Graphics.loadHWCImage(15)
hwc_credits = Graphics.loadHWCImage(16)

function LoadULE()
	for i = 1, 21 do
		if System.doesFileExist(rescuePath[i]) then
			System.loadELFNoIOPReset(rescuePath[i]);
		end
	end
end

function LoadESR()
	for i = 1, 10 do
		if System.doesFileExist(ESRPath[i]) then
			System.loadELFNoIOPReset(ESRPath[i]);
		end
	end
	for i = 1, 51 do
		PathA="mc0:/BOOT/"..ESRTryToGuess[i];
		PathB="mc1:/BOOT/"..ESRTryToGuess[i];
		if System.doesFileExist(PathA) then
			System.loadELFNoIOPReset(PathB);
		end
	end
end
ReloadFont=false;
function launchwithLang(languageValue)
	System.setSystemLanguage(languageValue);
	if imanomode=="Launch Disc" then
		if discLaunchMode == "NoDisc" then
			ErrorString = "There is no disc in drive";
			waittillframe=imanoframe+150;
		elseif discLaunchMode == "NotLaunchable" then
			ErrorString = "This disc is not a game";
			waittillframe=imanoframe+150;
		elseif discLaunchMode == "ESR" then
			Font.fmUnload();
			ReloadFont=true;
			LoadESR();
			ErrorString = "ESR is not installed";
			waittillframe=imanoframe+150;
		elseif discLaunchMode == "Normal" then
			Font.fmUnload();
			ReloadFont=true;
			System.launchCDVD();
			ErrorString = "Unable to launch disc";
			waittillframe=imanoframe+150;
		end
	elseif imanomode=="uLaunchELF / DEV1" then
		Font.fmUnload();
		ReloadFont=true;
		LoadULE();
		ErrorString = "uLaunchELF / DEV1 not found";
		waittillframe=imanoframe+150;
	end
	if ReloadFont then
		Font.fmLoad();
	end
end

infoDisco={};
infoDisco[1]=-1;

function readCDVD()
	infoDisco[0]=System.checkDiscTray();
	if infoDisco[0]==1 then
		infoDisco[1]=-1;
		infoDisco[2]=-100;
	else
		infoDisco[2]=System.getDiscType();
	end
	return infoDisco;
end

HWCDisc = readCDVD()
oldHWCDisc = HWCDisc;
oldHWCDisc[0] = 20000;

function setCDVD()
	HWCDisc[1]=System.checkESR();
	kindofDisc = 7;
	spinSpeed = 0;
	discLaunchMode = "NoDisc";
	if infoDisco[0]==1 then --Open Tray
		kindofDisc = 7;
		spinSpeed = 0;
		discLaunchMode = "NoDisc";
	elseif infoDisco[2]==2 then --Reading
		kindofDisc = 7;
		spinSpeed = 0.5;
		discLaunchMode = "NoDisc";
	elseif infoDisco[0]==-1 then --Open Tray
		kindofDisc = 7;
		spinSpeed = 0;
		discLaunchMode = "NoDisc";
	elseif infoDisco[2]==3 then --Reading
		kindofDisc = 7;
		spinSpeed = 0.5;
		discLaunchMode = "NoDisc";
	elseif infoDisco[2]==4 then --Reading
		kindofDisc = 7;
		spinSpeed = 0.5;
		discLaunchMode = "NoDisc";
	elseif infoDisco[2]==5 then --Reading
		kindofDisc = 7;
		spinSpeed = 0.5;
		discLaunchMode = "NoDisc";
	elseif infoDisco[2]==16 then --Error, Unknown Disc
		kindofDisc = 3;
		spinSpeed = 0.1;
		discLaunchMode = "NotLaunchable";
	elseif infoDisco[2]==6 then --Error, Unknown Disc
		kindofDisc = 3;
		spinSpeed = 0.1;
		discLaunchMode = "NotLaunchable";
	elseif infoDisco[2]==7 then --PS1 CD
		kindofDisc = 6;
		spinSpeed = 0.1;
		discLaunchMode = "NotLaunchable";
	elseif infoDisco[2]==8 then --PS1 CDDA
		kindofDisc = 6;
		spinSpeed = 0.1;
		discLaunchMode = "NotLaunchable";
	elseif infoDisco[2]==9 then --PS2 CD
		kindofDisc = 4;
		spinSpeed = 0.1;
		discLaunchMode = "Normal";
	elseif infoDisco[2]==10 then --PS2 CDDA
		kindofDisc = 4;
		spinSpeed = 0.1;
		discLaunchMode = "Normal";
	elseif infoDisco[2]==11 then --PS2 DVD
		kindofDisc = 5;
		spinSpeed = 0.1;
		discLaunchMode = "Normal";
	elseif infoDisco[2]==12 then --PS2 DVD ESR OFF
		kindofDisc = 2;
		spinSpeed = 0.1;
		discLaunchMode = "ESR";
	elseif infoDisco[2]==13 then --PS2 DVD ESR ON
		kindofDisc = 2;
		spinSpeed = 0.1;
		discLaunchMode = "ESR";
	elseif infoDisco[2]==14 then --AudioCD
		kindofDisc = 1;
		spinSpeed = 0.1;
		discLaunchMode = "NotLaunchable";
	elseif infoDisco[2]==15 then --DVDVideo
		kindofDisc = 2;
		spinSpeed = 0.1;
		discLaunchMode = "NotLaunchable";
	end
	if HWCDisc[1] == 1 then
		kindofDisc = 2;
		spinSpeed = 0.1;
		discLaunchMode = "ESR";
	end
end

ErrorString = "";
imanomode="Launch Disc";
discLaunchMode="NoDisc";
kindofDisc=7;
spinSpeed=0;
imanoSpin=0;
function spinDisc()
	imanoSpin=imanoSpin+spinSpeed;
	if imanoSpin > 360 then
		imanoSpin = imanoSpin-360;
	end
end

pad = Pads.get();
oldpad=pad;

temporaryVar = System.openFile("rom0:ROMVER", FREAD)
temporaryVar_size = System.sizeFile(temporaryVar)
ROMVER = System.readFile(temporaryVar, temporaryVar_size)
ROMVERRegion = string.sub(ROMVER,5,5)
System.closeFile(temporaryVar)

function clearscr()
	for whatever = 1, 5 do
		Screen.clear();
		Graphics.drawRect(0, 0, 1280, 960, Color.new(0, 0, 0, 255))
		Screen.waitVblankStart()
		Screen.flip()
	end
end

imanoframe = 1;
waittillframe = 1;

if ROMVERRegion~="E" then
	Screen.setMode(NTSC, 704, 480)
	minusOffset=16
	imanoVideoMode="NTSC"
else
	Screen.setMode(PAL, 704, 512)
	minusOffset=0
	imanoVideoMode="PAL"
end

if ROMVERRegion=="E" or ROMVERRegion=="A" then
	imanoLanguage=0; --If you're on a EU or US console, most probably you want to set JPN language, since it is not available in your region
else
	imanoLanguage=2; --If you're not on EU or US, then you might want to select French, Spanish, etc...
end
function languagePlus()
	if imanoLanguage ~= 7 then
		
		phasePlus=22
		
		for zzz = 1, 3 do
			HWCDisc = readCDVD()
			if HWCDisc[0] ~= oldHWCDisc[0] then
				setCDVD()
			elseif HWCDisc[1] == -1 then
				setCDVD()
			elseif HWCDisc[2] ~= oldHWCDisc[2] then
				setCDVD()
			end
			oldHWCDisc = HWCDisc;
			Screen.clear();
			Graphics.drawRect(0, 0, 1280, 960, Color.new(0, 0, 0, 255))
			Graphics.drawImageExtended(HWCgfx_background, 352, 256-minusOffset, 0, 0, 128, 128, 704, 512, 0.001, 255)
			Graphics.drawImage(HWCgfx_countryflags, 8, 423-minusOffset, 37)
			if imanomode=="Launch Disc" then
				if discLaunchMode == "NoDisc" then
					Graphics.drawImageExtended(HWCgfx_disc[kindofDisc], 352, 203-minusOffset, 0, 0, 296, 296, 296, 296, imanoSpin, 72)
				else
					Graphics.drawImageExtended(HWCgfx_disc[kindofDisc], 352, 203-minusOffset, 0, 0, 296, 296, 296, 296, imanoSpin, 255)
				end
				Graphics.drawImage(HWCgfx_overlay, 169, 20-minusOffset)
			else
				Graphics.drawImageExtended(HWCgfx_memorycard, 352, 203-minusOffset, 0, 0, 332, 370, 332, 370, 0.001, 255)
			end
			letsMultiply=imanoLanguage*86;
			Graphics.drawImageExtended(HWCgfx_countryflags, letsMultiply+51+phasePlus, 455-minusOffset, letsMultiply+phasePlus, 0, letsMultiply+86+phasePlus, 64, 86, 64, 0.001, 255)
			if imanoLanguage == 0 then
				Graphics.drawImage(HWCgfx_key_la, 42, 390-minusOffset, 37)
			else
				Graphics.drawImage(HWCgfx_key_la, 42, 390-minusOffset)
			end
			if imanoLanguage == 7 then
				Graphics.drawImage(HWCgfx_key_ra, 609, 390-minusOffset, 37)
			else
				Graphics.drawImage(HWCgfx_key_ra, 609, 390-minusOffset)
			end
			Graphics.drawImage(HWCgfx_key_left, 33, 182-minusOffset)
			Graphics.drawImage(HWCgfx_key_right, 612, 182-minusOffset)
			Font.fmPrint(127, 391-minusOffset, 0.77, ErrorString)
			Screen.waitVblankStart()
			spinDisc()
			Screen.flip()
			phasePlus=phasePlus+22
		end
		
		imanoLanguage = imanoLanguage + 1
	end
end

function languageMinus()
	if imanoLanguage ~= 0 then
		phasePlus=22
		
		for zzz = 1, 3 do
			HWCDisc = readCDVD()
			if HWCDisc[0] ~= oldHWCDisc[0] then
				setCDVD()
			elseif HWCDisc[1] == -1 then
				setCDVD()
			elseif HWCDisc[2] ~= oldHWCDisc[2] then
				setCDVD()
			end
			oldHWCDisc = HWCDisc;
			Screen.clear();
			Graphics.drawRect(0, 0, 1280, 960, Color.new(0, 0, 0, 255))
			Graphics.drawImageExtended(HWCgfx_background, 352, 256-minusOffset, 0, 0, 128, 128, 704, 512, 0.001, 255)
			Graphics.drawImage(HWCgfx_countryflags, 8, 423-minusOffset, 37)
			if imanomode=="Launch Disc" then
				if discLaunchMode == "NoDisc" then
					Graphics.drawImageExtended(HWCgfx_disc[kindofDisc], 352, 203-minusOffset, 0, 0, 296, 296, 296, 296, imanoSpin, 72)
				else
					Graphics.drawImageExtended(HWCgfx_disc[kindofDisc], 352, 203-minusOffset, 0, 0, 296, 296, 296, 296, imanoSpin, 255)
				end
				Graphics.drawImage(HWCgfx_overlay, 169, 20-minusOffset)
			else
				Graphics.drawImageExtended(HWCgfx_memorycard, 352, 203-minusOffset, 0, 0, 332, 370, 332, 370, 0.001, 255)
			end
			letsMultiply=imanoLanguage*86;
			Graphics.drawImageExtended(HWCgfx_countryflags, letsMultiply+51-phasePlus, 455-minusOffset, letsMultiply-phasePlus, 0, letsMultiply+86-phasePlus, 64, 86, 64, 0.001, 255)
			if imanoLanguage == 0 then
				Graphics.drawImage(HWCgfx_key_la, 42, 390-minusOffset, 37)
			else
				Graphics.drawImage(HWCgfx_key_la, 42, 390-minusOffset)
			end
			if imanoLanguage == 7 then
				Graphics.drawImage(HWCgfx_key_ra, 609, 390-minusOffset, 37)
			else
				Graphics.drawImage(HWCgfx_key_ra, 609, 390-minusOffset)
			end
			Graphics.drawImage(HWCgfx_key_left, 33, 182-minusOffset)
			Graphics.drawImage(HWCgfx_key_right, 612, 182-minusOffset)
			Font.fmPrint(127, 391-minusOffset, 0.77, ErrorString)
			Screen.waitVblankStart()
			spinDisc()
			Screen.flip()
			phasePlus=phasePlus+22
		end
	
		imanoLanguage = imanoLanguage - 1
	end
end

for zz = 1, 10 do
	pad = Pads.get();
	Screen.clear();
	Graphics.drawRect(0, 0, 1280, 960, Color.new(0, 0, 0, 255))
	Graphics.drawImageExtended(HWCgfx_background, 352, 256-minusOffset, 0, 0, 128, 128, 704, 512, 0.001, zz*25)
	Screen.waitVblankStart()
	Screen.flip()
	if Pads.check(pad, PAD_START) and not Pads.check(oldpad, PAD_START) then
		if imanoVideoMode=="PAL" then
			clearscr()
			Screen.setMode(NTSC, 704, 480)
			minusOffset=16
			imanoVideoMode="NTSC"
			clearscr()
		else
			clearscr()
			Screen.setMode(PAL, 704, 512)
			minusOffset=0
			imanoVideoMode="PAL"
			clearscr()
		end
	end
	oldpad=pad;
end

for zz = 1, 25 do
	pad = Pads.get();
	Screen.clear();
	Graphics.drawRect(0, 0, 1280, 960, Color.new(0, 0, 0, 255))
	Graphics.drawImageExtended(HWCgfx_background, 352, 256-minusOffset, 0, 0, 128, 128, 704, 512, 0.001, 255)
	Graphics.drawImage(hwc_credits, 0, 0-minusOffset, zz*10)
	Screen.waitVblankStart()
	Screen.flip()
	if Pads.check(pad, PAD_START) and not Pads.check(oldpad, PAD_START) then
		if imanoVideoMode=="PAL" then
			clearscr()
			Screen.setMode(NTSC, 704, 480)
			minusOffset=16
			imanoVideoMode="NTSC"
			clearscr()
		else
			clearscr()
			Screen.setMode(PAL, 704, 512)
			minusOffset=0
			imanoVideoMode="PAL"
			clearscr()
		end
	end
	oldpad=pad;
end

zz=1
while zz < 75 do
	pad = Pads.get();
	Screen.clear();
	Graphics.drawRect(0, 0, 1280, 960, Color.new(0, 0, 0, 255))
	Graphics.drawImageExtended(HWCgfx_background, 352, 256-minusOffset, 0, 0, 128, 128, 704, 512, 0.001, 255)
	Graphics.drawImage(hwc_credits, 0, 0-minusOffset, 255)
	Screen.waitVblankStart()
	Screen.flip()
	if Pads.check(pad, PAD_CROSS) and not Pads.check(oldpad, PAD_CROSS) then
		zz=777;
	elseif Pads.check(pad, PAD_CIRCLE) and not Pads.check(oldpad, PAD_CIRCLE) then
		zz=777;
	elseif Pads.check(pad, PAD_START) and not Pads.check(oldpad, PAD_START) then
		if imanoVideoMode=="PAL" then
			clearscr()
			Screen.setMode(NTSC, 704, 480)
			minusOffset=16
			imanoVideoMode="NTSC"
			clearscr()
		else
			clearscr()
			Screen.setMode(PAL, 704, 512)
			minusOffset=0
			imanoVideoMode="PAL"
			clearscr()
		end
	end
	zz = zz+1
	oldpad=pad;
end

for zz = 1, 25 do
	pad = Pads.get();
	Screen.clear();
	fadeOut=zz*10
	fadeOut=255-fadeOut
	Graphics.drawRect(0, 0, 1280, 960, Color.new(0, 0, 0, 255))
	Graphics.drawImageExtended(HWCgfx_background, 352, 256-minusOffset, 0, 0, 128, 128, 704, 512, 0.001, 255)
	Graphics.drawImage(hwc_credits, 0, 0-minusOffset, fadeOut)
	Screen.waitVblankStart()
	Screen.flip()
	if Pads.check(pad, PAD_START) and not Pads.check(oldpad, PAD_START) then
		if imanoVideoMode=="PAL" then
			clearscr()
			Screen.setMode(NTSC, 704, 480)
			minusOffset=16
			imanoVideoMode="NTSC"
			clearscr()
		else
			clearscr()
			Screen.setMode(PAL, 704, 512)
			minusOffset=0
			imanoVideoMode="PAL"
			clearscr()
		end
	end
	oldpad=pad;
end

for zz = 1, 25 do
	pad = Pads.get();
	fadeOut=zz*10
	fadeOut=255-fadeOut
	HWCDisc = readCDVD()
	if HWCDisc[0] ~= oldHWCDisc[0] then
		setCDVD()
	elseif HWCDisc[1] == -1 then
		setCDVD()
	elseif HWCDisc[2] ~= oldHWCDisc[2] then
		setCDVD()
	end
	oldHWCDisc = HWCDisc;
	Screen.clear();
	Graphics.drawRect(0, 0, 1280, 960, Color.new(0, 0, 0, 255))
	Graphics.drawImageExtended(HWCgfx_background, 352, 256-minusOffset, 0, 0, 128, 128, 704, 512, 0.001, 255)
	Graphics.drawImage(HWCgfx_countryflags, 8, 423-minusOffset, 37)
	if imanomode=="Launch Disc" then
		if discLaunchMode == "NoDisc" then
			Graphics.drawImageExtended(HWCgfx_disc[kindofDisc], 352, 203-minusOffset, 0, 0, 296, 296, 296, 296, imanoSpin, 72)
		else
			Graphics.drawImageExtended(HWCgfx_disc[kindofDisc], 352, 203-minusOffset, 0, 0, 296, 296, 296, 296, imanoSpin, 255)
		end
		Graphics.drawImage(HWCgfx_overlay, 169, 20-minusOffset)
	else
		Graphics.drawImageExtended(HWCgfx_memorycard, 352, 203-minusOffset, 0, 0, 332, 370, 332, 370, 0.001, 255)
	end
	letsMultiply=imanoLanguage*86;
	Graphics.drawImageExtended(HWCgfx_countryflags, letsMultiply+51, 455-minusOffset, letsMultiply, 0, letsMultiply+86, 64, 86, 64, 0.001, 255)
	if imanoLanguage == 0 then
		Graphics.drawImage(HWCgfx_key_la, 42, 390-minusOffset, 37)
	else
		Graphics.drawImage(HWCgfx_key_la, 42, 390-minusOffset)
	end
	if imanoLanguage == 7 then
		Graphics.drawImage(HWCgfx_key_ra, 609, 390-minusOffset, 37)
	else
		Graphics.drawImage(HWCgfx_key_ra, 609, 390-minusOffset)
	end
	Graphics.drawImage(HWCgfx_key_left, 33, 182-minusOffset)
	Graphics.drawImage(HWCgfx_key_right, 612, 182-minusOffset)
	Graphics.drawImageExtended(HWCgfx_background, 352, 256-minusOffset, 0, 0, 128, 128, 704, 512, 0.001, fadeOut)
	Screen.waitVblankStart()
	spinDisc()
	Screen.flip()
	if Pads.check(pad, PAD_START) and not Pads.check(oldpad, PAD_START) then
		if imanoVideoMode=="PAL" then
			clearscr()
			Screen.setMode(NTSC, 704, 480)
			minusOffset=16
			imanoVideoMode="NTSC"
			clearscr()
		else
			clearscr()
			Screen.setMode(PAL, 704, 512)
			minusOffset=0
			imanoVideoMode="PAL"
			clearscr()
		end
	end
	oldpad=pad;
end
while true do

	HWCDisc = readCDVD()
	if HWCDisc[0] ~= oldHWCDisc[0] then
		setCDVD()
	elseif HWCDisc[1] == -1 then
		setCDVD()
	elseif HWCDisc[2] ~= oldHWCDisc[2] then
		setCDVD()
	end
	oldHWCDisc = HWCDisc;


	pad = Pads.get();
	Screen.clear();
	Graphics.drawRect(0, 0, 1280, 960, Color.new(0, 0, 0, 255))
	Graphics.drawImageExtended(HWCgfx_background, 352, 256-minusOffset, 0, 0, 128, 128, 704, 512, 0.001, 255)
	Graphics.drawImage(HWCgfx_countryflags, 8, 423-minusOffset, 37)
	if imanomode=="Launch Disc" then
		if discLaunchMode == "NoDisc" then
			Graphics.drawImageExtended(HWCgfx_disc[kindofDisc], 352, 203-minusOffset, 0, 0, 296, 296, 296, 296, imanoSpin, 72)
		else
			Graphics.drawImageExtended(HWCgfx_disc[kindofDisc], 352, 203-minusOffset, 0, 0, 296, 296, 296, 296, imanoSpin, 255)
		end
		Graphics.drawImage(HWCgfx_overlay, 169, 20-minusOffset)
	else
		Graphics.drawImageExtended(HWCgfx_memorycard, 352, 203-minusOffset, 0, 0, 332, 370, 332, 370, 0.001, 255)
	end
	letsMultiply=imanoLanguage*86;
	Graphics.drawImageExtended(HWCgfx_countryflags, letsMultiply+51, 455-minusOffset, letsMultiply, 0, letsMultiply+86, 64, 86, 64, 0.001, 255)
	if imanoLanguage == 0 then
		Graphics.drawImage(HWCgfx_key_la, 42, 390-minusOffset, 37)
	else
		Graphics.drawImage(HWCgfx_key_la, 42, 390-minusOffset)
	end
	if imanoLanguage == 7 then
		Graphics.drawImage(HWCgfx_key_ra, 609, 390-minusOffset, 37)
	else
		Graphics.drawImage(HWCgfx_key_ra, 609, 390-minusOffset)
	end
	Graphics.drawImage(HWCgfx_key_left, 33, 182-minusOffset)
	Graphics.drawImage(HWCgfx_key_right, 612, 182-minusOffset)
	Font.fmPrint(127, 391-minusOffset, 0.77, ErrorString)
	Screen.waitVblankStart()
	spinDisc()
	Screen.flip()
	
	if Pads.check(pad, PAD_LEFT) and not Pads.check(oldpad, PAD_LEFT) then
		if imanomode=="Launch Disc" then
			imanomode="uLaunchELF / DEV1";
			ErrorString = "";
		elseif imanomode=="uLaunchELF / DEV1" then
			imanomode="Launch Disc";
			ErrorString = "";
		end
	elseif Pads.check(pad, PAD_RIGHT) and not Pads.check(oldpad, PAD_RIGHT) then
		if imanomode=="Launch Disc" then
			imanomode="uLaunchELF / DEV1";
			ErrorString = "";
		elseif imanomode=="uLaunchELF / DEV1" then
			imanomode="Launch Disc";
			ErrorString = "";
		end
	elseif Pads.check(pad, PAD_L1) and not Pads.check(oldpad, PAD_L1) then
		languageMinus()
	elseif Pads.check(pad, PAD_R1) and not Pads.check(oldpad, PAD_R1) then
		languagePlus()
	elseif Pads.check(pad, PAD_CROSS) and not Pads.check(oldpad, PAD_CROSS) then
		launchwithLang(imanoLanguage)
	elseif Pads.check(pad, PAD_CIRCLE) and not Pads.check(oldpad, PAD_CIRCLE) then
		launchwithLang(imanoLanguage)
	elseif Pads.check(pad, PAD_START) and not Pads.check(oldpad, PAD_START) then
		if imanoVideoMode=="PAL" then
			clearscr()
			Screen.setMode(NTSC, 704, 480)
			minusOffset=16
			imanoVideoMode="NTSC"
			clearscr()
		else
			clearscr()
			Screen.setMode(PAL, 704, 512)
			minusOffset=0
			imanoVideoMode="PAL"
			clearscr()
		end
	end
	imanoframe = imanoframe+1;
	if waittillframe == imanoframe then
		ErrorString = "";
	end
	oldpad=pad;
end